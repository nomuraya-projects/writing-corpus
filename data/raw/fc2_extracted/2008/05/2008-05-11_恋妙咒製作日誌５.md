---
title: "恋妙咒製作日誌５"
date: 2008-05-11
original_id: 84
---

メモ帖曰く、『エンカウント終わった……俺も終わった』と書いてます。
今のエンカウントシステムと比べるとちょっと面倒な手順を踏んでますが。
主人公の座標がＸ、Ｙのどちらでもいいのでズレた＝エンカウント率（歩行数）＋＋
ＩＦ（座標がズレた）
　　エンカウント値ＲＡＮＤ
ＩＦ（エンカウント値！＝エンカウントストップ）｛
　　エンカウントストップ＝エンカウント値
　　｝
ＩＦ（エンカウント率＜エンカウント値）｛
　　敵出現
　　（敵出現処理終了）
　　エンカウント率＝０
　　｝
の基本スタイルは変えません。
変えるのは、動作の条件。
ツクールシステムを使った条件式はユーザーが独自に指定した処理よりも優先度が高いので、絶対的に必要な処理だけをツクールシステムに読ませます。
ただ、２０００は融通が効かない事に、～以上、という値しか読みません。
今回の場合は下記しか該当しない事になります。
ＩＦ（エンカウント率＜エンカウント値）
まぁ、ツクールで指定出来るのも変数は一つだけなんですがね。
ちょっとプログラムをかじってる人間を気取ってスイッチは使いません。
どうしてもやむをえないケース（特殊技能が発動、敵の行動パターンによるスイッチのＯＮ／ＯＦＦなど仕様）には別ですが。
それと、管理が邪魔くさくなるので変数０／１については全てスイッチのＯＮ／ＯＦＦに対応させているのは容赦。
脱線しました。
重要なのはツクールのシステムに準拠する事なので、ちょっと形式を改めてみます。
マップイベント（エンカウント率＜エンカウントセーブ）
ＩＦ（エンカウント許可スイッチＯＮ）
エンカウントセーブ＝エンカウント率
エンカウント値ＲＡＮＤ
エンカウント検出イベント
座標検出
エンカウントバトル検出
どちらとも定期的に処理するようにすると多少なりの誤差が生じるのですが、今回のようなエンカウント率によるものの場合、誤差があって当然（ＲＡＮＤ）の処理なので全然気にならない結果になりました。
一応、マップイベントにエンカウントスイッチを入れておきました。
これはエンカウントさせたくないマップと分けるのにしか使わないので書く必要はないんですが。